-- [[ 
--    Script: Central de Combate, Visual & Movimenta√ß√£o 
--    Vers√£o: 2.8 (Mobile Optimized - Delta Fix) + Discord Auto-Join
-- ]]

local Kavo = loadstring(game:HttpGet("https://raw.githubusercontent.com/xHeptc/Kavo-UI-Library/main/source.lua"))()
local Window = Kavo.CreateLib("LUCK BLOXX üíé - LUCK HUB", "BloodTheme")

-- // Vari√°veis e Servi√ßos //
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local HttpService = game:GetService("HttpService")
local CoreGui = game:GetService("CoreGui")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera

-- Configura√ß√µes de Combate
local AimbotEnabled, FOVVisible, WallCheck = false, true, true
local FOVRadius = 100

-- Configura√ß√µes Visuais
local ESPEnabled = false
local ShowNames = true 
local ShowTracers = true
local ESPColor = Color3.fromRGB(0, 255, 255)

-- Vari√°veis de Movimenta√ß√£o
local WalkSpeedEnabled = false
local WalkSpeedValue = 16
local JumpPowerEnabled = false
local JumpPowerValue = 50
local FlyEnabled = false
local FlySpeed = 50

-- // FUN√á√ÉO DISCORD OTIMIZADA //
local function JoinDiscord()
    local invCode = "8zDTgbZSB3"
    local invLink = "https://discord.gg/" .. invCode
    
    -- Notifica√ß√£o na Interface do Roblox
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "LUCK HUB",
        Text = "Entre no Discord para atualiza√ß√µes! Link copiado.",
        Duration = 5
    })

    -- Copiar para Clipboard (PC e Mobile)
    if setclipboard then
        setclipboard(invLink)
    end

    -- Auto-Join RPC (Somente PC)
    task.spawn(function()
        for i = 6463, 6472 do
            local success = pcall(function()
                local req = (syn and syn.request) or (http and http.request) or http_request or request
                if req then
                    req({
                        Url = "http://127.0.0.1:"..tostring(i).."/rpc?v=1",
                        Method = "POST",
                        Headers = {
                            ["Content-Type"] = "application/json",
                            ["Origin"] = "https://discord.com"
                        },
                        Body = HttpService:JSONEncode({
                            cmd = "INVITE_BROWSER",
                            args = {code = invCode},
                            nonce = HttpService:GenerateGUID(false)
                        }),
                    })
                end
            end)
            if success then break end
        end
    end)
end

-- // FOV Circle (AJUSTADO PARA MOBILE/DELTA) //
local FOVCircle = Drawing.new("Circle")
FOVCircle.Thickness = 1.5
FOVCircle.Color = Color3.fromRGB(0, 255, 255)
FOVCircle.Transparency = 1
FOVCircle.Filled = false
FOVCircle.Visible = false

-- // ESP Logic //
local screenElements = {}
local function CreatePlayerESP(player)
    if screenElements[player] then return end
    screenElements[player] = {
        Tracer = Drawing.new("Line"),
        Box = Drawing.new("Square"),
        Tag = Drawing.new("Text")
    }
    local e = screenElements[player]
    e.Tracer.Thickness = 1
    e.Box.Thickness = 1
    e.Box.Filled = false
    e.Tag.Size = 14
    e.Tag.Center = true
    e.Tag.Outline = true
    e.Tag.Color = Color3.new(1, 1, 1)
end

-- // Main Loop //
RunService.RenderStepped:Connect(function()
    FOVCircle.Visible = FOVVisible
    FOVCircle.Radius = FOVRadius
    FOVCircle.Position = Vector2.new(Camera.ViewportSize.X/2, Camera.ViewportSize.Y/2)

    if AimbotEnabled then
        local closest = nil
        local dist = FOVRadius
        for _, p in pairs(Players:GetPlayers()) do
            if p ~= LocalPlayer and p.Character and p.Character:FindFirstChild("Head") then
                local head = p.Character.Head
                local pos, onScreen = Camera:WorldToViewportPoint(head.Position)
                if onScreen then
                    local mag = (Vector2.new(pos.X, pos.Y) - FOVCircle.Position).Magnitude
                    if mag < dist then
                        local rayDirection = (head.Position - Camera.CFrame.Position)
                        local params = RaycastParams.new()
                        params.FilterType = Enum.RaycastFilterType.Exclude
                        params.FilterDescendantsInstances = {LocalPlayer.Character, p.Character}
                        local result = workspace:Raycast(Camera.CFrame.Position, rayDirection, params)
                        if not WallCheck or not result then
                            dist = mag
                            closest = head
                        end
                    end
                end
            end
        end
        if closest then 
            Camera.CFrame = CFrame.new(Camera.CFrame.Position, closest.Position) 
        end
    end

    for player, obj in pairs(screenElements) do
        local char = player.Character
        if ESPEnabled and char and char:FindFirstChild("HumanoidRootPart") and char:FindFirstChild("Head") then
            local hrp = char.HumanoidRootPart
            local pos, onScreen = Camera:WorldToViewportPoint(hrp.Position)
            if onScreen then
                local headPos = Camera:WorldToViewportPoint(char.Head.Position + Vector3.new(0, 0.5, 0))
                local legPos = Camera:WorldToViewportPoint(hrp.Position - Vector3.new(0, 3, 0))
                local height = math.abs(headPos.Y - legPos.Y)
                local width = height * 0.6
                obj.Box.Color = ESPColor
                obj.Tracer.Color = ESPColor
                obj.Box.Size = Vector2.new(width, height)
                obj.Box.Position = Vector2.new(pos.X - width/2, pos.Y - height/2)
                obj.Box.Visible = true
                obj.Tracer.From = Vector2.new(Camera.ViewportSize.X/2, Camera.ViewportSize.Y)
                obj.Tracer.To = Vector2.new(pos.X, pos.Y + height/2)
                obj.Tracer.Visible = ShowTracers
                obj.Tag.Text = player.Name
                obj.Tag.Position = Vector2.new(pos.X, pos.Y - height/2 - 15)
                obj.Tag.Visible = ShowNames
            else
                obj.Box.Visible = false; obj.Tracer.Visible = false; obj.Tag.Visible = false
            end
        else
            obj.Box.Visible = false; obj.Tracer.Visible = false; obj.Tag.Visible = false
        end
    end

    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
        local hum = LocalPlayer.Character.Humanoid
        hum.WalkSpeed = WalkSpeedEnabled and WalkSpeedValue or 16
        hum.JumpPower = JumpPowerEnabled and JumpPowerValue or 50
    end

    if FlyEnabled and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
        local hrp = LocalPlayer.Character.HumanoidRootPart
        local moveDir = Vector3.new(0,0,0)
        if UserInputService:IsKeyDown(Enum.KeyCode.W) then moveDir = moveDir + Camera.CFrame.LookVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.S) then moveDir = moveDir - Camera.CFrame.LookVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.A) then moveDir = moveDir - Camera.CFrame.RightVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.D) then moveDir = moveDir + Camera.CFrame.RightVector end
        hrp.Velocity = moveDir * FlySpeed
        if moveDir.Magnitude == 0 then hrp.Velocity = Vector3.new(0, 0.1, 0) end
    end
end)

Players.PlayerAdded:Connect(CreatePlayerESP)
for _, p in pairs(Players:GetPlayers()) do if p ~= LocalPlayer then CreatePlayerESP(p) end end

-- // INTERFACE KAVO //
local MainTab = Window:NewTab("Combate & Visual")
local AimbotSection = MainTab:NewSection("Aimbot Settings")

AimbotSection:NewToggle("Ativar Aimbot", "Mira automaticamente nos inimigos", function(v) AimbotEnabled = v end)
AimbotSection:NewToggle("Mostrar C√≠rculo FOV", "Exibe a √°rea de alcance da mira", function(v) FOVVisible = v end)
AimbotSection:NewToggle("Wall Check", "N√£o mira atrav√©s de paredes", function(v) WallCheck = v end)
AimbotSection:NewSlider("FOV do Aimbot", "Aumenta o raio do c√≠rculo", 800, 30, function(v) FOVRadius = v end)

local VisualSection = MainTab:NewSection("Visual (ESP)")
VisualSection:NewToggle("Ativar Visuals (Box)", "Desenha caixas ao redor dos jogadores", function(v) ESPEnabled = v end)
VisualSection:NewToggle("Mostrar Linhas (Tracers)", "Linhas que ligam voc√™ aos jogadores", function(v) ShowTracers = v end)
VisualSection:NewToggle("Mostrar Nomes", "Mostra o Nickname", function(v) ShowNames = v end)
VisualSection:NewColorPicker("Cor do ESP", "Muda a cor das linhas e caixas", Color3.fromRGB(0, 255, 255), function(v) ESPColor = v end)

local MoveTab = Window:NewTab("Movimenta√ß√£o")
local SpeedSection = MoveTab:NewSection("Velocidade & Pulo")
SpeedSection:NewToggle("Ativar Speed Mod", "Habilita a velocidade customizada", function(v) WalkSpeedEnabled = v end)
SpeedSection:NewSlider("Velocidade (WalkSpeed)", "Padr√£o √© 16", 300, 16, function(v) WalkSpeedValue = v end)
SpeedSection:NewToggle("Ativar Jump Mod", "Habilita o pulo customizado", function(v) JumpPowerEnabled = v end)
SpeedSection:NewSlider("Poder do Pulo", "Padr√£o √© 50", 500, 50, function(v) JumpPowerValue = v end)

local FlySection = MoveTab:NewSection("Voo")
FlySection:NewToggle("Fly (Voo)", "Permite voar pelo mapa", function(v) FlyEnabled = v end)
FlySection:NewSlider("Velocidade do Voo", "Velocidade de deslocamento no ar", 500, 10, function(v) FlySpeed = v end)

-- // NOVA ABA INFO & DISCORD //
local InfoTab = Window:NewTab("Info / Suporte")
local DiscordSection = InfoTab:NewSection("Comunidade")

DiscordSection:NewButton("Discord / Suporte", "Copia o link e entra automaticamente (PC)", function()
    JoinDiscord()
end)

DiscordSection:NewLabel("Vers√£o Atual: 2.8")

-- // CENTRALIZA√á√ÉO AUTOM√ÅTICA DA UI //
task.spawn(function()
    wait(0.5)
    for _, gui in pairs(CoreGui:GetChildren()) do
        if gui:IsA("ScreenGui") and gui:FindFirstChild("Main") then
            local MainFrame = gui.Main
            MainFrame.Position = UDim2.new(0.5, -MainFrame.Size.X.Offset/2, 0.5, -MainFrame.Size.Y.Offset/2)
        end
    end
end)

-- // BOT√ÉO FLUTUANTE OTIMIZADO //
local FloatingGui = Instance.new("ScreenGui")
local MainButton = Instance.new("TextButton")
local Corner = Instance.new("UICorner")
local Stroke = Instance.new("UIStroke")

FloatingGui.Name = "LuckHub_Floating"
FloatingGui.Parent = CoreGui
FloatingGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

MainButton.Name = "MainButton"
MainButton.Parent = FloatingGui
MainButton.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
MainButton.Position = UDim2.new(0.1, 0, 0.2, 0)
MainButton.Size = UDim2.new(0, 60, 0, 60)
MainButton.Font = Enum.Font.GothamBold
MainButton.Text = "LUCK"
MainButton.TextColor3 = Color3.fromRGB(255, 255, 255)
MainButton.TextSize = 14
MainButton.Active = true
MainButton.Draggable = true 

Corner.CornerRadius = UDim.new(0, 30) 
Corner.Parent = MainButton

Stroke.Color = Color3.fromRGB(255, 255, 255)
Stroke.Thickness = 2
Stroke.Parent = MainButton

-- Toggle Visibility
MainButton.MouseButton1Click:Connect(function()
    for _, gui in pairs(CoreGui:GetChildren()) do
        if gui:IsA("ScreenGui") and gui:FindFirstChild("Main") then
            gui.Enabled = not gui.Enabled
        end
    end
end)

-- Executar fun√ß√£o de Discord ao carregar
JoinDiscord()

print("Luck Hub v2.8 Mobile Fix + Discord Carregado!")
